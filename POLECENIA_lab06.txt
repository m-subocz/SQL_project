ZAD 1.

a. SELECT AVG(waga) FROM wikingowie.kreatura WHERE rodzaj LIKE 'wiking';

b. SELECT rodzaj,AVG(waga),COUNT(*) FROM wikingowie.kreatura GROUP BY rodzaj;

c. SELECT rodzaj, avg(2020-year(dataUr)) FROM kreatura GROUP BY rodzaj;

ZAD 2.

a. SELECT SUM waga FROM zasob GROUP BY rodzaj;

b. SELECT nazwa,AVG(waga) FROM zasob WHERE ilosc >= 4 GROUP BY nazwa HAVING SUM(waga)>10;

c. SELECT rodzaj,COUNT(DISTINCT(nazwa)) AS liczba FROM zasob GROUP BY rodzaj HAVING liczba>1;

ZAD 3.

a. SELECT nazwa FROM kreatury,ekwipunek WHERE kreatury.idKreatury=ekwipunek.idKreatury;

b. SELECT k.nazwa,e.idZasobu,e.ilosc,z.nazwa FROM kreatura k.ekwipunek e.zasob z WHERE k.idKreatury=e.idKreatury AND e.idZasobu=z.idZasobu;

c. SELECT k.idKreatury, k.nazwa,e.idKreatury FROM kreatura k LEFT JOIN ekwipunek e ON k.idKreatury=e.idKreatury WHERE e.idKreatury IS NULL;

ZAD 4.

a. SELECT k.nazwa,z.nazwa,k.dataUr FROM kreatura k, zasob z NATURAL JOIN ekwipunek e WHERE year(k.dataUr) LIKE '167%' AND k.rodzaj = 'wiking';

b. SELECT k.nazwa, z.rodzaj, k.dataUr FROM kreatura k INNER JOIN ekwipunek e ON k.idKreatury = e.idKreatury INNER JOIN zasob z ON z.idZasobu = e.idZasobu WHERE z.rodzaj='jedzenie' ORDER BY k.dataUr DESC LIMIT 5;

c. SELECT k.nazwa, k2.nazwa FROM kreatura k, kreatura k2 where k.idKreatury=k2.idKreatury+5;

ZAD 5.

a. SELECT k.rodzaj, AVG(e.ilosc *z.waga) FROM kreatura AS k, ekwipunek AS e, zasob AS z where k.idKreatury=e.idKreatury AND e.idZasobu=z.idZasobu AND k.rodzaj NOT IN('malpa','waz')GROUP BY rodzaj HAVING SUM(e.ilosc) < 30;

b. SELECT DISTINCT k.rodzaj, (SELECT CONCAT(k2.nazwa, " - " , k2.dataUr) FROM kreatura k2 WHERE k.rodzaj=k2.rodzaj ORDER BY k2.dataUr LIMIT 1) AS naj_s, (SELECT CONCAT(k2.nazwa, " - " , k2.dataUr) FROM kreatura k2 WHERE k.rodzaj=k2.rodzaj ORDER BY k2.dataUr DESC LIMIT 1) AS naj_m FROM kreatura k;
